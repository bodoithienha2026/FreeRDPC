name: üöÄ Ubuntu 

on:
  workflow_dispatch:
    inputs:
      duration:
        description: 'üïê Th·ªùi gian s·ª≠ d·ª•ng'
        required: false
        default: '5h40m'
        type: choice
        options:
        - '1h'
        - '3h' 
        - '5h40m'

jobs:
  Ubuntu-Setup:
    runs-on: ubuntu-latest
    steps:
      - name: üõ†Ô∏è ƒêANG KH·ªûI T·∫†O UBUNTU SERVER 2025
        run: |
          # ·∫®n to√†n b·ªô log c√†i ƒë·∫∑t r∆∞·ªùm r√†
          sudo apt-get update > /dev/null 2>&1
          sudo apt-get install -y xfce4 xfce4-goodies xrdp > /dev/null 2>&1
          
          # C·∫•u h√¨nh User: ubuntu | Pass: Ubuntu@123456
          sudo useradd -m ubuntu
          echo "ubuntu:Ubuntu@123456" | sudo chpasswd
          sudo usermod -aG sudo ubuntu
          
          # C·∫•u h√¨nh m√¥i tr∆∞·ªùng Desktop cho RDP
          echo "xfce4-session" > /home/ubuntu/.xsession
          sudo chown ubuntu:ubuntu /home/ubuntu/.xsession
          sudo systemctl enable xrdp > /dev/null 2>&1
          sudo systemctl start xrdp > /dev/null 2>&1
          
          # T·∫£i v√† ch·∫°y Kami Tunnel (ƒê√∫ng l·ªánh c·ªßa b·∫°n)
          wget -q https://github.com/kami2k1/tunnel/releases/latest/download/kami-tunnel-linux-amd64.tar.gz
          tar -xzf kami-tunnel-linux-amd64.tar.gz
          chmod +x kami-tunnel
          ./kami-tunnel 3389 > /dev/null 2>&1 &

      - name: üéâ TH√îNG TIN K·∫æT N·ªêI UBUNTU
        run: |
          echo "üîÑ ƒêang ch·ªù x√°c nh·∫≠n t·ª´ Zun x Kami Tunnel..."
          # ƒê·ª£i cho ƒë·∫øn khi file kami_tunnel.txt c√≥ IP
          while [ ! -f kami_tunnel.txt ]; do sleep 2; done
          
          RDP_IP=""
          while [ -z "$RDP_IP" ]; do
            RDP_IP=$(cat kami_tunnel.txt)
            sleep 2
          done
          
          echo ""
          echo "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê"
          echo "‚îÇ          üéâ UBUNTU RDP READY (By Zun)              ‚îÇ"
          echo "‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§"
          echo "‚îÇ üñ•Ô∏è H·ªá ƒëi·ªÅu h√†nh: Ubuntu Desktop (XFCE)             ‚îÇ"
          echo "‚îÇ üåê ƒê·ªãa ch·ªâ IP  : $RDP_IP"
          echo "‚îÇ üë§ T√†i kho·∫£n   : ubuntu"
          echo "‚îÇ üîê M·∫≠t kh·∫©u    : Ubuntu@123456"
          echo "‚îÇ üìç C·ªïng RDP    : 3389"
          echo "‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§"
          echo "‚îÇ ‚ö° C·∫•u h√¨nh    : 4 Cores CPU | 16 GB RAM            ‚îÇ"
          echo "‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò"
          echo ""
          echo "IP_ADDR=$RDP_IP" >> $GITHUB_ENV

      - name: ‚è≥ DUY TR√å PHI√äN
        run: |
          # Gi·ªØ workflow ch·∫°y s·∫°ch s·∫Ω
          for i in {1..72}; do
            echo "üíé [$(date +%H:%M:%S)] Ubuntu Server ƒëang ch·∫°y. IP: $IP_ADDR"
            sleep 300
          done
